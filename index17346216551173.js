import{N as D,x as $,c as z,z as K,S as H,E as n,m as J,B as Y,D as o,a7 as F,F as c,J as h,H as e,V as R,Q as _,a8 as Z,_ as ee,t as ae,v as oe,r as B,C as te,X as se,y as le,A as re,W as A,M as S,O as y,G as ne,I as ie}from"./index1734621655117.js";import{b as j,c as ce,e as P,i as ue,g as me,h as de}from"./vee-validate1734621655117.js";import{u as pe,c as fe,Q as ge,a as be,r as ve,L as ye,b as _e,d as U}from"./rowPerPageOptions1734621655117.js";import{u as X,Q as E,a as Se,t as Pe}from"./index17346216551174.js";import{i as L}from"./itPatrimonyService1734621655117.js";import{F as he}from"./FileSaver.min1734621655117.js";import{i as Te}from"./itListStatus1734621655117.js";import"./QSkeleton1734621655117.js";import"./auditProject1734621655117.js";const xe=()=>{const d=X(),{mutateAsync:p,isPending:l}=j({mutationFn:u=>L.changeStatus(u)});return{changeStatus:async({id:u,status:f})=>{const m=await p({id:u,status:!f});D.create({message:m,color:"positive"}),d.invalidateQueries({queryKey:[E.GET_IT_PATRIMONY_LIST]}),d.invalidateQueries({queryKey:[E.GET_IT_PATRIMONY_ITEM,{id:u}]})},isPending:l}},Ie={class:"text-h6"},ke={class:"flex justify-end q-mt-lg"},Ve=$({__name:"change-it-item-status-modal",props:{isOpenRef:{type:Boolean},item:{},onClose:{type:Function}},setup(d){const p=z(()=>d.isOpenRef),{t:l}=K.global,{changeStatus:a,isPending:u}=xe(),f=async()=>{await a(d.item),d.onClose()};return(m,g)=>(Y(),H(J,{modelValue:p.value,"onUpdate:modelValue":g[0]||(g[0]=t=>p.value=t)},{default:n(()=>[o(Z,{class:"q-pa-md q-dialog"},{default:n(()=>[o(F,null,{default:n(()=>[c("div",Ie,h(e(l)(m.item.status?"inactiveITItemStatusTitle":"activeITItemStatusTitle")),1)]),_:1}),o(F,{class:"q-pt-none"},{default:n(()=>[R(h(e(l)(m.item.status?"inactiveITItemStatusDescription":"activeITItemStatusDescription")),1)]),_:1}),o(F,null,{default:n(()=>[c("div",ke,[o(_,{color:"grey-8",class:"q-mr-sm",onClick:m.onClose,label:e(l)("cancel")},null,8,["onClick","label"]),o(_,{type:"submit",color:"primary",label:e(l)("confirm"),loading:e(u),onClick:f},null,8,["label","loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),qe=ee(Ve,[["__scopeId","data-v-cff2503b"]]),Ne=({handleSubmit:d})=>{const{mutateAsync:p,isPending:l}=j({mutationFn:async u=>await L.exportReport(u)});return{exportReport:d(async u=>{const f=await p(u);he.saveAs(f,"PATRIMONIO_TI.xlsx"),D.create({message:"O relatório XLSX foi gerado.",color:"positive"})}),isPendingExport:l}},Ce=ce().shape({patrimonio:P().nullable().max(15,"Número do patrimônio deve ter menos que 15 caracteres").test("patrimony-or-others","Preencha o N° Patrimônio ou os outros campos, mas não ambos",function(d){const{nomeMaquina:p,serialMaquina:l,serialOffice:a,modelo:u,versaoOffice:f,sistemaOperacional:m,status:g}=this.parent,t=p||l||a||u||f||m||g!==void 0;return d?!t:!0}),nomeMaquina:P().nullable(),serialMaquina:P().nullable(),serialOffice:P().nullable(),modelo:P().nullable(),versaoOffice:P().nullable(),sistemaOperacional:P().nullable(),status:ue().nullable()}),Oe=ae("useGetITPatrimonyListStore",()=>{const d=pe(),{handleSubmit:p,resetForm:l,defineField:a,errors:u}=me({validationSchema:Ce,initialValues:d.data.value}),f=p(s=>{d.setFormData(s)}),[m,g]=a("patrimonio"),[t,k]=a("nomeMaquina"),[i,T]=a("serialMaquina"),[V,x]=a("serialOffice"),[q,N]=a("modelo"),[C,O]=a("versaoOffice"),[M,w]=a("sistemaOperacional"),[Q,v]=a("status");return{search:d,handleSubmit:p,errors:u,onSubmit:f,resetForm:l,patrimonyNumber:m,desktopName:t,desktopSerial:i,officeSerial:V,model:q,officeVersion:C,operationalSystem:M,status:Q,patrimonyNumberProps:g,desktopNameProps:k,desktopSerialProps:T,officeSerialProps:x,modelProps:N,officeVersionProps:O,operationalSystemProps:w,statusProps:v}}),Me=()=>{const{invalidateQueries:d}=X(),p=Oe(),{search:l,handleSubmit:a,onSubmit:u,resetForm:f}=p,{errors:m,patrimonyNumber:g,desktopName:t,desktopSerial:k,officeSerial:i,model:T,officeVersion:V,operationalSystem:x,status:q,patrimonyNumberProps:N,desktopNameProps:C,desktopSerialProps:O,officeSerialProps:M,modelProps:w,officeVersionProps:Q,operationalSystemProps:v,statusProps:s}=oe(p),I=z(()=>({...l.data,page:l.pagination.page,rowsPerPage:l.pagination.rowsPerPage})),{data:r,isFetching:b}=Se({queryKey:[E.GET_IT_PATRIMONY_LIST,I],queryFn:async()=>{const G=await L.getAll(I.value);return l.setRowsNumber(G.total),G}}),W=()=>{f(),l.reset(),d({queryKey:[E.GET_IT_PATRIMONY_LIST],exact:!0})};return{data:r,isFetching:b,pagination:l.pagination,setPagination:l.setPagination,reset:W,onSubmit:u,handleSubmit:a,errors:m,form:{patrimonyNumber:g,desktopName:t,desktopSerial:k,officeSerial:i,model:T,officeVersion:V,operationalSystem:x,status:q,patrimonyNumberProps:N,desktopNameProps:C,desktopSerialProps:O,officeSerialProps:M,modelProps:w,officeVersionProps:Q,operationalSystemProps:v,statusProps:s}}},we={class:"row q-col-gutter-md q-mt-sm"},Qe={class:"col-lg-3 col-sm-6 col-xs-12"},Re={class:"col-lg-3 col-sm-6 col-xs-12"},Ee={class:"col-lg-3 col-sm-6 col-xs-12"},Fe={class:"col-lg-3 col-sm-6 col-xs-12"},Ae={class:"row q-col-gutter-md q-mt-sm"},Ue={class:"col-lg-3 col-sm-6 col-xs-12"},Le={class:"col-lg-3 col-sm-6 col-xs-12"},Ge={class:"col-lg-3 col-sm-6 col-xs-12"},Be={class:"col-lg-3 col-sm-6 col-xs-12"},De={class:"flex justify-end q-mt-lg"},$e={class:"q-mt-lg"},ze={class:"flex row items-center justify-between full-width"},Ke={class:"text-subtitle2"},Ye={class:"full-width row flex-center text-grey-7"},je=["textContent"],sa=$({__name:"index",setup(d){const p=B({id:0,status:!1}),l=B(!1),{t:a}=K.global,u=le(),{data:f,isFetching:m,pagination:g,form:t,handleSubmit:k,errors:i,setPagination:T,reset:V,onSubmit:x}=Me(),{isPendingExport:q,exportReport:N}=Ne({handleSubmit:k}),{title:C,subtitle:O}=u.meta,M=(v,s)=>{p.value={id:v,status:s},l.value=!0},w=[{title:a("search"),header:0,havePermission:!0,expandItem:!0}],Q=fe([{key:"numPatrimonio",label:a("patrimonyNumber")},{key:"nomeMaquina",label:a("desktopName")},{key:"serialMaquina",label:a("desktopSerial")},{key:"nomeResponsavel",label:a("accountable")},{key:"lotacao",label:a("capacity")},{key:"ativo",label:a("status"),fn:v=>v?"Ativo":"Inativo"},{key:"acao",label:a("action")}]);return(v,s)=>{const I=re("router-link");return Y(),te(se,null,[o(e(Pe),{container:w,"sub-title":e(O),title:e(C)},{"right-top":n(()=>[o(I,{to:{name:e(A).CREATE_IT_ITEM}},{default:n(()=>[o(_,{label:e(a)("new"),color:"primary",icon:"add"},null,8,["label"])]),_:1},8,["to"])]),section0:n(()=>[c("form",{novalidate:"",onSubmit:s[8]||(s[8]=ne((...r)=>e(x)&&e(x)(...r),["prevent"]))},[c("div",we,[c("div",Qe,[o(S,y({modelValue:e(t).patrimonyNumber.value,"onUpdate:modelValue":s[0]||(s[0]=r=>e(t).patrimonyNumber.value=r)},e(t).patrimonyNumberProps.value,{"no-error-icon":"",error:!!e(i).patrimonio,"error-message":e(i).patrimonio,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("patrimonyNumber"),type:"number"}),null,16,["modelValue","error","error-message","label"])]),c("div",Re,[o(S,y({modelValue:e(t).desktopName.value,"onUpdate:modelValue":s[1]||(s[1]=r=>e(t).desktopName.value=r)},e(t).desktopNameProps.value,{"no-error-icon":"",error:!!e(i).nomeMaquina,"error-message":e(i).nomeMaquina,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("desktopName"),maxlength:20}),null,16,["modelValue","error","error-message","label"])]),c("div",Ee,[o(S,y({modelValue:e(t).desktopSerial.value,"onUpdate:modelValue":s[2]||(s[2]=r=>e(t).desktopSerial.value=r)},e(t).desktopSerialProps.value,{"no-error-icon":"",error:!!e(i).serialMaquina,"error-message":e(i).serialMaquina,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("desktopSerial"),maxlength:50}),null,16,["modelValue","error","error-message","label"])]),c("div",Fe,[o(S,y({modelValue:e(t).model.value,"onUpdate:modelValue":s[3]||(s[3]=r=>e(t).model.value=r)},e(t).modelProps.value,{"no-error-icon":"",error:!!e(i).modelo,"error-message":e(i).modelo,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("model"),maxlength:50}),null,16,["modelValue","error","error-message","label"])])]),c("div",Ae,[c("div",Ue,[o(S,y({modelValue:e(t).officeVersion.value,"onUpdate:modelValue":s[4]||(s[4]=r=>e(t).officeVersion.value=r)},e(t).officeVersionProps.value,{"no-error-icon":"",error:!!e(i).versaoOffice,"error-message":e(i).versaoOffice,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("officeVersion"),maxlength:50}),null,16,["modelValue","error","error-message","label"])]),c("div",Le,[o(S,y({modelValue:e(t).officeSerial.value,"onUpdate:modelValue":s[5]||(s[5]=r=>e(t).officeSerial.value=r)},e(t).officeSerialProps.value,{"no-error-icon":"",error:!!e(i).serialOffice,"error-message":e(i).serialOffice,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("officeSerial"),maxlength:50}),null,16,["modelValue","error","error-message","label"])]),c("div",Ge,[o(S,y({modelValue:e(t).operationalSystem.value,"onUpdate:modelValue":s[6]||(s[6]=r=>e(t).operationalSystem.value=r)},e(t).operationalSystemProps.value,{"no-error-icon":"",error:!!e(i).sistemaOperacional,"error-message":e(i).sistemaOperacional,dense:"",clearable:"","clear-icon":"close","emit-value":"","map-options":"",label:e(a)("operationalSystem"),maxlength:25}),null,16,["modelValue","error","error-message","label"])]),c("div",Be,[o(de,y({modelValue:e(t).status.value,"onUpdate:modelValue":s[7]||(s[7]=r=>e(t).status.value=r)},e(t).statusProps.value,{options:e(Te),error:!!e(i).status,"error-message":e(i).status,dense:"","map-options":"","emit-value":"",clearable:"","clear-icon":"close",label:e(a)("status")}),null,16,["modelValue","options","error","error-message","label"])])]),c("div",De,[o(_,{disable:e(m),label:e(a)("clear"),class:"q-mr-sm",color:"grey-8",onClick:e(V)},null,8,["disable","label","onClick"]),o(_,{disable:e(m),label:e(a)("search"),color:"primary",icon:"search",type:"submit"},null,8,["disable","label"])])],32),c("div",$e,[o(ge,{class:"bg-grey-3 rounded-borders shadow-1","expand-icon-toggle":"","default-opened":""},{header:n(()=>[c("div",ze,[c("span",Ke,h(e(a)("listing")),1),o(ie,{name:"fa fa-file-excel",size:"sm",class:"cursor-pointer q-mr-md",color:"primary",onClick:e(N),loading:e(q),disable:e(m)},null,8,["onClick","loading","disable"])])]),default:n(()=>{var r;return[o(be,{class:"shadow-0","row-key":"id",columns:e(Q),rows:((r=e(f))==null?void 0:r.list)??[],"rows-per-page-options":e(ve),loading:e(m),"hide-no-data":e(m),pagination:e(g),onRequest:s[9]||(s[9]=b=>e(T)(b.pagination)),"onUpdate:pagination":e(T)},{loading:n(()=>[o(ye)]),"no-data":n(()=>[c("div",Ye,[c("span",{textContent:h(e(a)("noRecordsFound"))},null,8,je)])]),"body-cell-acao":n(({row:b})=>[o(_e,{"auto-width":"",class:"q-gutter-xs"},{default:n(()=>[o(I,{to:{name:e(A).VIEW_IT_ITEM,params:{id:b.id}}},{default:n(()=>[o(_,{color:"grey-8",flat:"",round:"",icon:"fa fa-eye",size:"sm"},{default:n(()=>[o(U,null,{default:n(()=>[R(h(e(a)("view")),1)]),_:1})]),_:1})]),_:2},1032,["to"]),o(I,{to:{name:e(A).UPDATE_IT_ITEM,params:{id:b.id}}},{default:n(()=>[o(_,{color:"grey-8",flat:"",round:"",icon:"fa fa-pencil",size:"sm"},{default:n(()=>[o(U,null,{default:n(()=>[R(h(e(a)("update")),1)]),_:1})]),_:1})]),_:2},1032,["to"]),o(_,{color:"grey-8",flat:"",round:"",icon:b.ativo?"fa fa-ban":"fa fa-check",size:"sm",onClick:()=>M(b.id,b.ativo)},{default:n(()=>[o(U,null,{default:n(()=>[R(h(e(a)(b.ativo?"inactivate":"activate")),1)]),_:2},1024)]),_:2},1032,["icon","onClick"])]),_:2},1024)]),_:1},8,["columns","rows","rows-per-page-options","loading","hide-no-data","pagination","onUpdate:pagination"])]}),_:1})])]),_:1},8,["sub-title","title"]),o(qe,{"is-open-ref":l.value,"on-close":()=>l.value=!1,item:p.value},null,8,["is-open-ref","on-close","item"])],64)}}});export{sa as default};
