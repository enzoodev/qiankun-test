var W=Object.defineProperty;var k=(l,a,e)=>a in l?W(l,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[a]=e;var h=(l,a,e)=>k(l,typeof a!="symbol"?a+"":a,e);import{V as p,d as z,w as H,B as K,D as v}from"./index17346208643602.js";import{i as X,B as Y,r as ee,c as ae,M as m,N as d,O as g,_ as f}from"./index1734620864360.js";import{u as te,b as n,m as se}from"./field.service1734620864360.js";const{t:i}=X.global,re=Y("field",()=>{const l=ee(1),a=ae(()=>m().shape({nome:d().required().label(i("message.name")),descricao:d().required().label(i("message.description")),ordem:d().required().label(i("message.order")).matches(/^\d+$/,i("message.thisFieldMustOnlyContainNumbers")).test("isNumber",i("message.fieldLessThanZero"),s=>parseInt(s)>0).test("validTotal",`${i("message.fieldOrderLimitWarning")} ${l.value}`,s=>parseInt(s)<=l.value),tipo:d().required().label(i("message.type")),tipoValor:d().required().label(i("message.typeValue")),quantidadeCaracteres:d().required().label(i("message.charsQuantity")).matches(/^\d+$/,i("message.thisFieldMustOnlyContainNumbers")).test("isNumber",i("message.fieldLessThanZero"),s=>parseInt(s)>0),calculos:g().of(m().shape({campoDoValor:d().required().label(i("message.field")),idValor:d().required().label(i("message.fieldValue")),calculo:d().required().label(i("message.typeOfCalculation")),campoCalculado:d().required().label(i("message.fieldToCalculation"))})),averbacoes:g().of(m().shape({idAverbacao:d().required().label(i("message.fieldValue")),calculo:d().required().label(i("message.typeOfCalculation")),campoCalculado:d().required().label(i("message.fieldToCalculation"))})),obrigatorio:f().notRequired().label("Obrigatorio"),destaque:f().notRequired().label("Destaque"),valores:g().of(m().shape({valor:d().required().label("valor").when("tipoValor",{is:s=>s===p.SELECAO,then:s=>s.matches(/^\d+$/,i("message.thisFieldMustOnlyContainNumbers"))}),descricao:d().notRequired().label("descrição").when("tipoValor",{is:s=>s===p.SELECAO,then:s=>s.required()})})).when("tipoValor",{is:s=>s===p.SELECAO,then:s=>s.test("hasContent",i("message.for_the_field_to_be_selection_type_at_least_1_value_must_be_registered"),o=>(o==null?void 0:o.length)!=null&&(o==null?void 0:o.length)>0)}).when("tipoValor",{is:s=>s===p.PADRAO,then:s=>s.test("hasContent1",'Quando "Tipo Valor" for "Padrão" é requerido um valor',o=>(o==null?void 0:o.length)!=null&&(o==null?void 0:o.length)>0)})})),{defineField:e,setFieldValue:t,resetForm:r,setValues:c,validate:u,resetField:V,values:y,errors:w,handleSubmit:T}=te({validationSchema:a,initialValues:{valores:[],calculos:[],averbacoes:[],obrigatorio:!1,destaque:!1}}),[O,S]=e("nome"),[_,q]=e("descricao"),[C,A]=e("ordem"),[L,B]=e("tipo"),[D,I]=e("tipoValor"),[N,E]=e("quantidadeCaracteres"),[$,U]=e("valores"),[x,M]=e("obrigatorio"),[P,R]=e("destaque"),[j,Q]=e("calculos"),[Z,G]=e("averbacoes");return{nome:O,nomeAttrs:S,descricao:_,descricaoAttrs:q,ordem:C,ordemAttrs:A,tipo:L,tipoAttrs:B,tipoValor:D,tipoValorAttrs:I,quantidadeCaracteres:N,quantidadeCaracteresAttrs:E,valores:$,valoresAttrs:U,destaque:P,destaqueAttrs:R,calculos:j,calculosAttrs:Q,averbacoes:Z,averbacoesAttrs:G,errors:w,handleSubmit:T,maxNumberInOrder:l,obrigatorio:x,obrigatorioAttrs:M,values:y,validateFn:async()=>{const{valid:s,errors:o}=await u({mode:"force"});if(s)return y;throw Object.values(o).forEach(J=>z.createNotify(String(J),"warning")),new Error("Form inválido")},resetForm:r,setFieldValue:t,resetField:V,setValues:c}});var ie=Object.defineProperty,le=Object.getOwnPropertyDescriptor,oe=(l,a,e,t)=>{for(var r=le(a,e),c=l.length-1,u;c>=0;c--)(u=l[c])&&(r=u(a,e,r)||r);return r&&ie(a,e,r),r};class b{constructor(a){this.apiService=a}async getFieldTypeValues(){return this.apiService.override_url("tipo"),await this.apiService.find_all()}async getFieldValuesByFieldId(a){return this.apiService.override_url("por-campo"),await this.apiService.find_by_id(a)}async getFieldValuesListByFieldIdsList(a){return this.apiService.override_url("por-campos"),await this.apiService.save(a).then(e=>typeof e=="string"?JSON.parse(e):e)}}oe([H({group:"getFieldValuesListByFieldIdsList"})],b.prototype,"getFieldValuesListByFieldIdsList");const F=new b(new K("https://dev.gerais.mg.def.br","depe/service".concat("/valor")));class de extends v{async getFieldTypeValues(){const{dados:a}=await F.getFieldTypeValues();return a}async getFieldValuesByFieldId(a){const{dados:e}=await F.getFieldValuesByFieldId(a);return e}}const ne=new de;class ce extends v{constructor(){super(...arguments);h(this,"fieldStore",re())}async getAllFields(){return await n.getAllFields().then(({dados:e})=>e)}async getFieldsByType(e){return await n.getFieldsByType(e)}async getFieldsByCategory(e){return await n.getFieldsByCategory(e)}async getFieldsByTypeFromTheSameLevelToTheDeepest(e,t){return await n.getFieldsByTypeFromTheSameLevelToTheDeepest(e,t)}async saveFieldsOrder(e){const t=e.map((r,c)=>({id:r.id,ordem:c+1}));await n.saveFieldsOrder(t)}async getFieldById(e){return await n.getFieldById(e).then(({dados:t})=>t)}formatDataTSaveOrUpdateField(e){var t;return{...e,calculos:(t=e.calculos)==null?void 0:t.map(r=>({idValor:r.idValor,calculo:r.calculo,campoCalculado:r.campoCalculado}))}}actionsAfterSaveOrUpdateField(e){this.createNotify(e,"positive"),this.goBack(),this.fieldStore.resetForm()}async saveField(e){const t=this.formatDataTSaveOrUpdateField(e);return await n.saveField(t).then(({mensagem:r})=>this.actionsAfterSaveOrUpdateField(r))}async updateField(e){const t=this.formatDataTSaveOrUpdateField(e);return await n.updateField(t).then(({mensagem:r})=>{this.actionsAfterSaveOrUpdateField(r)})}async deleteField(e){return await n.deleteField(e).then(({mensagem:t})=>this.createNotify(t,"positive"))}async getMaxNumberInOrder(e){const{dados:t}=await n.getMaxNumberInOrder(e);return t}async getFieldTypes(){const{dados:e}=await n.getFieldTypes();return e}async fetchAllDataToCreateField(){const[e,t]=await Promise.all([this.getFieldTypes(),ne.getFieldTypeValues()]);return{fieldTypes:e,fieldTypeValues:t}}async getFieldsListByIds(e){const t=e.map(({campo:r})=>r);await n.getFieldsListByIds(t).then(({dados:r})=>se().SET_FIELD_GENERICO(r))}async getFieldValuesListByFieldIdsList(e){return(await F.getFieldValuesListByFieldIdsList(e)).dados}}const ye=new ce;export{ne as F,F as a,ye as f,re as u};
